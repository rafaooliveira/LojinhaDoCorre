"use strict";!function(){function e(e){return""!==e.trim()}function t(e,t){t?a(e):(A=e,n()),i()}function o(e){if(!e)return void s(document.querySelector(T).getAttribute("data-size-invalid"));var o=document.querySelector("[data-persona]"),r=document.querySelector("[data-builder-persona]"),n=N.getState().pdp.persona.selected;_=e,r?window.freedom.nsPubSub.pub("builder.personalization.get",t):o?window.freedom.nsPubSub.pub("personalization.get",t):n&&n.state?t(n.list,!0):t(void 0)}function r(){if(document.querySelectorAll("#buy-box .product-size-selector .radio-options li.active").length)window.freedom.nsPubSub.pub("ColorFlavorSize.select.size",o);else{var e=document.querySelector(".test-ab-cta-floating li.active a").getAttribute("data-sku");o(e)}}function n(){if(A){var t=[];A.name&&""!==A.name&&e(A.name)&&t.push({sku:A.nameSku,value:A.name}),A.number&&""!==A.number&&t.push({sku:A.numberSku,value:A.number}),B=t}}function a(e){try{B=e}catch(t){console.error("call-to-action.buildPersonaList",t)}}function l(){try{var e="";return null!==document.querySelector("PRODUCT_BUY_BUTTON")&&(e=document.querySelector("PRODUCT_BUY_BUTTON").getAttribute("data-seller"))?+e:(e=document.querySelector("[product-data-seller]").getAttribute("product-data-seller"),e?+e:0)}catch(t){return console.error("call-to-action.getSeller",t),0}}function c(){return 0===l()?B:[]}function i(){var e={items:[{sku:_,quantity:E,seller:l(),personalizations:c()}]};console.log("call-to-action-test-ab.js",e),d(e)}function u(e){if(e.data.errors&&e.data.errors.length>0){var t="data-error",o=null;e.data.errors[0].code===x&&(t="data-error-"+x),"personalization.not.allowed"===e.data.errors[0].code&&(o=window.freedom.i18n.getMessage("product_errors_cart_persona_not_allow"));var r=document.querySelectorAll(T);if(r)for(var n=r.length;n--;)s(o||r[n].getAttribute(t))}else window.freedom.nsPubSub.pub("quickView.hasQuickView")?(window.freedom.nsPubSub.pub("quickView.close"),window.freedom.nsPubSub.pub("miniCart.fixed")):window.location.href="/cart"}function d(e){var t={buttonWithLoading:document.querySelector(T),method:"post",data:e,success:function(e){u(e)},error:function(){s(document.querySelector(T).getAttribute("data-error"))}};window.freedom.restClient.request("/cart/add",t)}function s(e){try{var t=document.querySelectorAll("#buy-error");if(t)for(var o=t.length;o--;)t[o].innerHTML=e,window.freedom.removeClass(t[o],"hidden");document.querySelector(".test-ab-cta-floating .right #buy-button-cta").removeAttribute("disabled")}catch(r){console.error("call-to-action.showBuyError",r)}}function f(e){try{if(e)r();else{var t=window.freedom.i18n.getMessage("personalization_fields_generic_error");s(t)}}catch(o){console.error("call-to-action.checkPersona",o),r()}}function m(){try{var e=document.querySelector("[data-persona]"),t=document.querySelector("[data-new-persona]"),o=document.querySelector("[data-builder-persona]");e&&t&&!o?window.freedom.nsPubSub.pub("ColorFlavorSize.handleBuyEvent.checkPersona",f):r()}catch(n){console.error("call-to-action.handleBuyEvent",n)}}function b(){if(P&&L){var e=L.getBoundingClientRect().top;e<-556?P.className.indexOf("cta-open-floater")<0&&(window.freedom.addClass(L,"cta-open-floater"),g()):window.freedom.removeClass(L,"cta-open-floater")}}function w(){P&&window.addEventListener("scroll",b)}function y(){if(null!==document.querySelector(".test-ab-cta-floating .rating-stars>a")){var e=document.querySelectorAll(".rating-stars>a");e.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault();var t=document.querySelector(".reviews").offsetTop;window.scrollTo(0,t-160)})})}}function p(){window.freedom.live("button.tell_me_back","click",function(){var e=document.querySelectorAll('#buy-box [data-type=size] .product-item[qa-option="available"]');e.length?e[0].click():(e=document.querySelectorAll('#buy-box [data-type=color] .ns-color[qa-option="available"]'),e[0].click()),document.querySelector(".test-ab-cta-floating .form-tell-me").style.display="none"})}function v(){document.querySelector(".test-ab-cta-floating .product-info").style.display="none",document.querySelector(".test-ab-cta-floating .selector-color").style.display="block",window.freedom.addClass(L,"cta-product-size")}function S(){document.querySelector(".test-ab-cta-floating .product-info").style.display="block",document.querySelector(".test-ab-cta-floating .selector-color").style.display="none"}function g(){document.querySelectorAll(".buy-error").forEach(function(e){e.classList.add("hidden")})}function q(){window.freedom.live("#buy-box .sku-select [data-type=size] li","click",function(e){e.target.parentElement.className.indexOf("unavailable")>=0?(window.freedom.removeClass(L,"cta-product-size"),window.freedom.addClass(L,"cta-product-unavailable")):window.freedom.removeClass(L,"cta-product-unavailable")}),window.freedom.nsPubSub.sub("color-flavor-size.changeHtml.after",function(){window.setTimeout(function(){document.querySelectorAll("li.unavailable.active").length?document.querySelectorAll(".tell-me-button-wrapper").length?(window.freedom.addClass(L,"cta-product-unavailable"),window.freedom.removeClass(L,"cta-product-size")):(window.freedom.removeClass(L,"cta-product-unavailable"),S()):document.querySelectorAll(".tell-me-button-wrapper").length?(window.freedom.addClass(L,"cta-product-unavailable"),window.freedom.removeClass(L,"cta-product-size")):(document.querySelectorAll("[data-type=size] li.active").length&&(document.querySelector("body").classList.remove("cta-product-size"),S()),window.freedom.removeClass(L,"cta-product-unavailable"))},1e3)}),window.freedom.live("#buy-button-cta","click",function(e){e.preventDefault(),document.querySelector(".test-ab-cta-floating .right #buy-button-cta").setAttribute("disabled","disabled"),document.querySelectorAll("#buy-box .product-size-selector .radio-options li.active").length?m():v()})}function h(e){try{e.classList.contains("unavailable")?(window.freedom.removeClass(L,"cta-product-size"),window.freedom.addClass(L,"cta-product-unavailable"),document.querySelector(".test-ab-cta-floating .form-tell-me").style.display="block"):m()}catch(t){console.error("call-to-action.handleBuyEvent",t)}}function k(){window.freedom.live(".test-ab-cta-floating [data-type=size] li","click",function(e){e.preventDefault(),h(this)})}function C(){null!==P.getAttribute("data-cta-floater")&&(w(),q(),k(),p(),y(),document.querySelectorAll(".tell-me-button-wrapper").length&&(window.freedom.removeClass(L,"cta-product-size"),window.freedom.addClass(L,"cta-product-unavailable"),document.querySelector(".test-ab-cta-floating .form-tell-me").style.display="block"))}function z(){P=document.querySelector(".test-ab-cta-floating"),P&&C()}var A,_,P,T=".buy-button-now",B=[],E=1,x="item.stock.unavailable",L=document.getElementsByTagName("body")[0],N=window.freedom.NsStore;!function(){window.setTimeout(function(){z()},2500)}()}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIl9yZWZhY3RvcmluZy9fY29tcG9uZW50cy9wcm9kdWN0L2NhbGwtdG8tYWN0aW9uL2FsbC90ZXN0LWFiL2NhbGwtdG8tYWN0aW9uLXRlc3QtYWIubWluLmpzIl0sIm5hbWVzIjpbImlzTm90V2hpdGVTcGFjZXNPbmx5T3JVbmRlZmluZWQiLCJzdHJpbmciLCJ0cmltIiwicHViU3ViUGVyc29uYUdldEhhbmRsZXIiLCJwZXJzb25hbGl6YXRpb24iLCJpc0xpc3QiLCJidWlsZFBlcnNvbmFMaXN0IiwiUEVSU09OQSIsImJ1aWxkUGVyc29uYVBheWxvYWQiLCJidWlsZEFkZFRvQ2FydFBheWxvYWQiLCJwdWJTdWJDb2xvckZsYXZvclNpemVIYW5kbGVyIiwic2t1Iiwic2hvd0J1eUVycm9yIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiUFJPRFVDVF9CVVlfQlVUVE9OIiwiZ2V0QXR0cmlidXRlIiwiaGFzRm9ybVBlcnNvbmEiLCJoYXNCdWlsZGVyUGVyc29uYSIsInNlbGVjdGVkUGVyc29uYSIsInN0b3JlIiwiZ2V0U3RhdGUiLCJwZHAiLCJwZXJzb25hIiwic2VsZWN0ZWQiLCJTSVpFIiwid2luZG93IiwiZnJlZWRvbSIsIm5zUHViU3ViIiwicHViIiwic3RhdGUiLCJsaXN0IiwidW5kZWZpbmVkIiwiaXNTaXplVmFsaWQiLCJxdWVyeVNlbGVjdG9yQWxsIiwibGVuZ3RoIiwic2t1UHJvZCIsInBlcnNvbmFsaXphdGlvbnMiLCJuYW1lIiwicHVzaCIsIm5hbWVTa3UiLCJ2YWx1ZSIsIm51bWJlciIsIm51bWJlclNrdSIsIlBFUlNPTkFfUEFZTE9BRCIsInBlcnNvbmFMaXN0IiwiZXJyb3IiLCJjb25zb2xlIiwiZ2V0U2VsbGVyIiwic2VsbGVyIiwiZ2V0UGVyc29uYVBheWxvYWQiLCJwYXlsb2FkIiwiaXRlbXMiLCJxdWFudGl0eSIsIkRFRkFVTFRfUVVBTlRJVFkiLCJsb2ciLCJhZGRUb0NhcnQiLCJyZWRpcmVjdE9yU2hvd0J1c2luZXNzRXJyb3IiLCJyZXN1bHQiLCJkYXRhIiwiZXJyb3JzIiwiYnRuQXRyaWJ1dGUiLCJlcnJvck1lc3NhZ2UiLCJjb2RlIiwiU1RPQ0tfRVJST1JfQ09ERSIsImkxOG4iLCJnZXRNZXNzYWdlIiwiYnRucyIsImkiLCJsb2NhdGlvbiIsImhyZWYiLCJvcHRpb25zIiwiYnV0dG9uV2l0aExvYWRpbmciLCJtZXRob2QiLCJzdWNjZXNzIiwicmVzdENsaWVudCIsInJlcXVlc3QiLCJtZXNzYWdlIiwiZXJyb3JFbGVtZW50cyIsImlubmVySFRNTCIsInJlbW92ZUNsYXNzIiwicmVtb3ZlQXR0cmlidXRlIiwiY2hlY2tQZXJzb25hIiwicGVyc29uYVN0YXR1cyIsImhhbmRsZUJ1eUV2ZW50IiwiaGFzUGVyc29uYSIsIm5ld1BlcnNvbmEiLCJzaG93RmxvYXRlciIsImN0YUZsb2F0ZXIiLCJib2R5IiwiYm9keVRvcCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInRvcCIsImNsYXNzTmFtZSIsImluZGV4T2YiLCJhZGRDbGFzcyIsImhpZGVNZXNzYWdlRXJyb3IiLCJzY3JvbGxGdW5jdGlvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJhbmNob3JSZXZpZXdzIiwiYW5jaG9yIiwiZm9yRWFjaCIsImVsZW1lbnQiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwiZGl2UmV2aWV3cyIsIm9mZnNldFRvcCIsInNjcm9sbFRvIiwidGVsbE1lYmFjayIsImxpdmUiLCJzaXplIiwiY2xpY2siLCJzdHlsZSIsImRpc3BsYXkiLCJzaG93U2l6ZUZsb2F0aW5nIiwic2hvd0luZm9Qcm9kIiwiY2xhc3NMaXN0IiwiYWRkIiwib2JzZXJ2ZVNpemUiLCJ0YXJnZXQiLCJwYXJlbnRFbGVtZW50Iiwic3ViIiwic2V0VGltZW91dCIsInJlbW92ZSIsInNldEF0dHJpYnV0ZSIsImhhbmRsZUJ1eUV2ZW50Q1RBRmxvYXRpbmciLCJjb250YWlucyIsInNldExpc3RlbmVyc0NUQUZsb2F0aW5nIiwidGhpcyIsImluaXRGbG9hdGVyIiwiaW5pdCIsImdldEVs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RixNQUFPdEMsR0FDUEMsUUFBUUQsTUFBTSxnQ0FBaUNBLElBU25ELFFBQVNpRixLQUNQckcsT0FBT0MsUUFBUWtGLEtBQUssNENBQTZDLFFBQVMsU0FBVU4sR0FDbEZBLEVBQU1DLGlCQUNOcUIsRUFBMEJHLFFBUzlCLFFBQVNDLEtBQzZDLE9BQWhEekMsRUFBV3hFLGFBQWEsc0JBQzFCaUYsSUFDQXFCLElBRUFTLElBQ0FuQixJQUNBVCxJQUVHdEYsU0FBU3FCLGlCQUFpQiwyQkFBMkJDLFNBQ3REVCxPQUFPQyxRQUFRcUQsWUFBWVMsRUFBSyxvQkFDaEMvRCxPQUFPQyxRQUFRb0UsU0FBU04sRUFBSywyQkFDN0I1RSxTQUFTQyxjQUFjLHVDQUF1Q2tHLE1BQU1DLFFBQVUsVUFVcEYsUUFBU2lCLEtBQ1AxQyxFQUFhM0UsU0FBU0MsY0FBYyx5QkFDakMwRSxHQUNEeUMsSUEzZUosR0FHRTFILEdBQ0FrQixFQUVBK0QsRUFORXpFLEVBQXFCLGtCQUN2QjZCLEtBQ0FVLEVBQW1CLEVBR25CVSxFQUFtQix5QkFFbkJ5QixFQUFPNUUsU0FBU3NILHFCQUFxQixRQUFRLEdBRTNDL0csRUFBUU0sT0FBT0MsUUFBUXlHLFNBc2UxQixXQUNDMUcsT0FBT2dHLFdBQVcsV0FDaEJRLEtBQ0EiLCJmaWxlIjoiX3JlZmFjdG9yaW5nL19jb21wb25lbnRzL3Byb2R1Y3QvY2FsbC10by1hY3Rpb24vYWxsL3Rlc3QtYWIvY2FsbC10by1hY3Rpb24tdGVzdC1hYi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG4oZnVuY3Rpb24oKSB7XG4gIHZhciBQUk9EVUNUX0JVWV9CVVRUT04gPSAnLmJ1eS1idXR0b24tbm93JyxcbiAgICBQRVJTT05BX1BBWUxPQUQgPSBbXSxcbiAgICBERUZBVUxUX1FVQU5USVRZID0gMSxcbiAgICBQRVJTT05BLFxuICAgIFNJWkUsXG4gICAgU1RPQ0tfRVJST1JfQ09ERSA9ICdpdGVtLnN0b2NrLnVuYXZhaWxhYmxlJyxcbiAgICBjdGFGbG9hdGVyLFxuICAgIGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYm9keScpWzBdO1xuXG4gIHZhciBzdG9yZSA9IHdpbmRvdy5mcmVlZG9tLk5zU3RvcmU7XG5cbiAgLyoqXG4gICAqIFtpc05vdFdoaXRlU3BhY2VzT25seU9yVW5kZWZpbmVkXVxuICAgKiB0cmltIHBlcnNvbmEgc3RyaW5nIG5hbWVcbiAgICogQHBhcmFtICB7U3RyaW5nfSAgc3RyaW5nIFtkZXNjcmlwdGlvbl1cbiAgICogQHJldHVybiB7Qm9vbGVhbn0gICAgICAgIFtkZXNjcmlwdGlvbl1cbiAgICovXG4gIGZ1bmN0aW9uIGlzTm90V2hpdGVTcGFjZXNPbmx5T3JVbmRlZmluZWQoc3RyaW5nKSB7XG4gICAgcmV0dXJuIHN0cmluZy50cmltKCkgIT09ICcnO1xuICB9XG5cbiAgLyoqXG4gICAqIFtwdWJTdWJQZXJzb25hR2V0SGFuZGxlcl1cbiAgICogUGVyc29uYWxpemF0aW9uIHZhbHVlcyBjYWxsYmFjayBoYW5kbGVyXG4gICAqIFNldHMgcGVyc29uYWxpemF0aW9uIGluIFBFUlNPTkEgZ2xvYmFsIGNvbnN0YW50XG4gICAqIENhbGwgYnVpbGRQZXJzb25hUGF5bG9hZCB0byBjcmVhdGUgcGVyc29uYSBzZW5kIHBheWxvYWQgdG8gYWRkVG9DYXJ0XG4gICAqIENhbGwgYnVpbGRBZGRUb0NhcnRQYXlsb2FkIHRvIGNyZWF0ZSBhZGRUb0NhcnQgcGF5bG9hZFxuICAgKiBAcGFyYW0gIHtPYmplY3R9IHBlcnNvbmFsaXphdGlvbiBbcGVyc29uYWxpemF0aW9uIHZhbHVlcyBmcm9tIHBlcnNvbmEgcHVic3ViIGNhbGxiYWNrXVxuICAgKiBAcGFyYW0gIHtib29sZWFufSBpc0xpc3QgW3RvIGtub3cgaWYgdGhlIHBlcnNvbmEgaXMgYW4gYXJyYXkgb3Igbm90XVxuICAgKiBAcmV0dXJuIHt9XG4gICAqL1xuICBmdW5jdGlvbiBwdWJTdWJQZXJzb25hR2V0SGFuZGxlcihwZXJzb25hbGl6YXRpb24sIGlzTGlzdCkge1xuICAgIGlmKGlzTGlzdCkge1xuICAgICAgLy9uZXcgcGVyc29uYWxpemF0aW9uIGZvcm1hdCAoYXJyYXkpXG4gICAgICBidWlsZFBlcnNvbmFMaXN0KHBlcnNvbmFsaXphdGlvbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIFBFUlNPTkEgPSBwZXJzb25hbGl6YXRpb247XG4gICAgICBidWlsZFBlcnNvbmFQYXlsb2FkKCk7XG4gICAgfVxuXG4gICAgYnVpbGRBZGRUb0NhcnRQYXlsb2FkKCk7XG4gIH1cblxuICAvKipcbiAgICogW3B1YlN1YkNvbG9yRmxhdm9yU2l6ZUhhbmRsZXJdXG4gICAqIDEgLSBUcmlnZ2VycyBhIHB1YiBzdWIgZXZlbnQgdG8gY29sb3IgZmxhdm9yIHNpemUgYW5kIHVzZXMgY2FsbGJhY2sgZnVuY3Rpb24gdG8gc2V0IFNJWkUgYW5kXG4gICAqIHNlbmQgYnVpbGRwYXlsb2FkIGZ1bmN0aW9uXG4gICAqIEByZXR1cm4ge31cbiAgICovXG4gIGZ1bmN0aW9uIHB1YlN1YkNvbG9yRmxhdm9yU2l6ZUhhbmRsZXIoc2t1KSB7XG4gICAgaWYoIXNrdSkge1xuICAgICAgc2hvd0J1eUVycm9yKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoUFJPRFVDVF9CVVlfQlVUVE9OKS5nZXRBdHRyaWJ1dGUoJ2RhdGEtc2l6ZS1pbnZhbGlkJykpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgaGFzRm9ybVBlcnNvbmEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1wZXJzb25hXScpO1xuICAgIHZhciBoYXNCdWlsZGVyUGVyc29uYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWJ1aWxkZXItcGVyc29uYV0nKTtcbiAgICB2YXIgc2VsZWN0ZWRQZXJzb25hID0gc3RvcmUuZ2V0U3RhdGUoKS5wZHAucGVyc29uYS5zZWxlY3RlZDtcblxuICAgIFNJWkUgPSBza3U7XG4gICAgLyogcmVhZCBzaXplIHZhbHVlcyB2aWEgcHViIHN1YiBhbmQgcHVibGlzaCBpdCBpbnRvIGdsb2JhbCB2YXJpYWJsZSBTSVpFICovXG4gICAgaWYoaGFzQnVpbGRlclBlcnNvbmEpIHsgLy9pZiBidWlsZGVyIHBlcnNvbmFcbiAgICAgIHdpbmRvdy5mcmVlZG9tLm5zUHViU3ViLnB1YignYnVpbGRlci5wZXJzb25hbGl6YXRpb24uZ2V0JywgcHViU3ViUGVyc29uYUdldEhhbmRsZXIpO1xuICAgIH0gZWxzZSBpZiAoaGFzRm9ybVBlcnNvbmEpIHsgLy9pZiBmb3JtIHBlcnNvbmFcbiAgICAgIHdpbmRvdy5mcmVlZG9tLm5zUHViU3ViLnB1YigncGVyc29uYWxpemF0aW9uLmdldCcsIHB1YlN1YlBlcnNvbmFHZXRIYW5kbGVyKTtcbiAgICB9IGVsc2UgaWYgKHNlbGVjdGVkUGVyc29uYSAmJiBzZWxlY3RlZFBlcnNvbmEuc3RhdGUpIHsgLy9pZiBwZXJzb25hIGhhcyBiZWVuIHNhdmVkIGludG8gc3RvcmVcbiAgICAgIHB1YlN1YlBlcnNvbmFHZXRIYW5kbGVyKHNlbGVjdGVkUGVyc29uYS5saXN0LCB0cnVlKTtcbiAgICB9IGVsc2UgeyAvLyBpZiB0cmFkaXRpb25hbCBwZXJzb25hXG4gICAgICBwdWJTdWJQZXJzb25hR2V0SGFuZGxlcih1bmRlZmluZWQpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBbaXNTaXplVmFsaWRdXG4gICAqIFN0YXJ0cyBhIHB1YiBzdWIgZXZlbnQgZm9yIGNvbG9yIGZsYXZvciBzaXplIHRvIGdhcmFudGVlIHNpemUgaW4gYmVmb3JlIHNlbmQgYWRkVG9DYXJ0XG4gICAqIEBjYWxsYmFjayBmdW5jdGlvbiB7cHViU3ViQ29sb3JGbGF2b3JTaXplSGFuZGxlcn1cbiAgICovXG4gIGZ1bmN0aW9uIGlzU2l6ZVZhbGlkKCkge1xuICAgIGlmKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNidXktYm94IC5wcm9kdWN0LXNpemUtc2VsZWN0b3IgLnJhZGlvLW9wdGlvbnMgbGkuYWN0aXZlJykubGVuZ3RoKSB7XG4gICAgICB3aW5kb3cuZnJlZWRvbS5uc1B1YlN1Yi5wdWIoJ0NvbG9yRmxhdm9yU2l6ZS5zZWxlY3Quc2l6ZScsIHB1YlN1YkNvbG9yRmxhdm9yU2l6ZUhhbmRsZXIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgc2t1UHJvZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50ZXN0LWFiLWN0YS1mbG9hdGluZyBsaS5hY3RpdmUgYScpLmdldEF0dHJpYnV0ZSgnZGF0YS1za3UnKTtcbiAgICAgIHB1YlN1YkNvbG9yRmxhdm9yU2l6ZUhhbmRsZXIoc2t1UHJvZCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFtidWlsZFBlcnNvbmFQYXlsb2FkXVxuICAgKiBidWlsZCBwZXJzb25hbGl6YXRpb24gcGF5bG9hZCBhbmQgc2V0cyBpdCBpbiB7UEVSU09OQV9QQVlMT0FEfVxuICAgKiBAcmV0dXJuIHt9XG4gICAqL1xuICBmdW5jdGlvbiBidWlsZFBlcnNvbmFQYXlsb2FkKCkge1xuICAgIGlmKFBFUlNPTkEpIHtcbiAgICAgIHZhciBwZXJzb25hbGl6YXRpb25zID0gW107XG4gICAgICAvKiB7T2JqZWN0fSBwZXJzb25hICovXG4gICAgICAvKiBTZXQgbmFtZSAqL1xuICAgICAgaWYgKFBFUlNPTkEubmFtZVxuICAgICAgICYmIFBFUlNPTkEubmFtZSAhPT0gJydcbiAgICAgICAmJiBpc05vdFdoaXRlU3BhY2VzT25seU9yVW5kZWZpbmVkKFBFUlNPTkEubmFtZSkpIHtcbiAgICAgICAgcGVyc29uYWxpemF0aW9ucy5wdXNoKHtcbiAgICAgICAgICBza3U6IFBFUlNPTkEubmFtZVNrdSxcbiAgICAgICAgICB2YWx1ZTogUEVSU09OQS5uYW1lXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvKiBTZXQgTnVtYmVyICovXG4gICAgICBpZiAoUEVSU09OQS5udW1iZXIgJiYgUEVSU09OQS5udW1iZXIgIT09ICcnKSB7XG4gICAgICAgIHBlcnNvbmFsaXphdGlvbnMucHVzaCh7XG4gICAgICAgICAgc2t1OiBQRVJTT05BLm51bWJlclNrdSxcbiAgICAgICAgICB2YWx1ZTogUEVSU09OQS5udW1iZXJcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIFBFUlNPTkFfUEFZTE9BRCA9IHBlcnNvbmFsaXphdGlvbnM7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gYnVpbGRQZXJzb25hTGlzdChwZXJzb25hTGlzdCkge1xuICAgIHRyeSB7XG4gICAgICBQRVJTT05BX1BBWUxPQUQgPSBwZXJzb25hTGlzdDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignY2FsbC10by1hY3Rpb24uYnVpbGRQZXJzb25hTGlzdCcsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogZnVuY3Rpb24gdG8gc2VhcmNoIGFuZCBnZXQgdGhlIHNlbGxlciBvZiBwcm9kdWN0XG4gICAqL1xuICBmdW5jdGlvbiBnZXRTZWxsZXIoKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vaGFzIHNlbGxlciBvbiB0aGUgYnV0dG9uXG4gICAgICB2YXIgc2VsbGVyID0gJyc7XG4gICAgICBpZihkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdQUk9EVUNUX0JVWV9CVVRUT04nKSAhPT0gbnVsbCkge1xuICAgICAgICBzZWxsZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdQUk9EVUNUX0JVWV9CVVRUT04nKS5nZXRBdHRyaWJ1dGUoJ2RhdGEtc2VsbGVyJyk7XG4gICAgICAgIGlmKHNlbGxlcikgcmV0dXJuICtzZWxsZXI7XG4gICAgICB9XG5cbiAgICAgIC8vaWYgaGFzIG5vIHNlbGxlciBvbiB0aGUgYnV0dG9uXG4gICAgICBzZWxsZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbcHJvZHVjdC1kYXRhLXNlbGxlcl0nKS5nZXRBdHRyaWJ1dGUoJ3Byb2R1Y3QtZGF0YS1zZWxsZXInKTtcbiAgICAgIGlmKHNlbGxlcikgcmV0dXJuICtzZWxsZXI7XG5cbiAgICAgIC8vZGVmYXVsdFxuICAgICAgcmV0dXJuIDA7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ2NhbGwtdG8tYWN0aW9uLmdldFNlbGxlcicsIGVycm9yKTtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgcGVyc29uYWxpemF0aW9uIHBheWxvYWRcbiAgICogQHJldHVybiB7QXJyYXl9XG4gICAqL1xuICBmdW5jdGlvbiBnZXRQZXJzb25hUGF5bG9hZCgpIHtcbiAgICAvLyBHZXQgcGVyc29uYSBwYXlsb2FkIG9ubHkgaWYgc2VsbGVyIGlzIG5ldHNob2VzXG4gICAgaWYoZ2V0U2VsbGVyKCkgPT09IDApIHtcbiAgICAgIHJldHVybiBQRVJTT05BX1BBWUxPQUQ7XG4gICAgfVxuICAgIHJldHVybiBbXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBbYnVpbGRBZGRUb0NhcnRQYXlsb2FkXVxuICAgKiBCdWlsZCBhZGRUb0NhcnQgcGF5bG9hZCBhbmQgY2FsbHMgYWRkVG9DYXJ0IHBheWxvYWQgd2l0aCBpdGVtcyBzZXQgaW5cbiAgICogQHJldHVybiB7fVxuICAgKi9cbiAgZnVuY3Rpb24gYnVpbGRBZGRUb0NhcnRQYXlsb2FkKCkge1xuICAgIHZhciBwYXlsb2FkID0ge1xuICAgICAgaXRlbXM6IFt7XG4gICAgICAgIHNrdTogU0laRSxcbiAgICAgICAgcXVhbnRpdHk6IERFRkFVTFRfUVVBTlRJVFksXG4gICAgICAgIHNlbGxlcjogZ2V0U2VsbGVyKCksXG4gICAgICAgIHBlcnNvbmFsaXphdGlvbnM6IGdldFBlcnNvbmFQYXlsb2FkKClcbiAgICAgIH1dXG4gICAgfTtcbiAgICBjb25zb2xlLmxvZygnY2FsbC10by1hY3Rpb24tdGVzdC1hYi5qcycsIHBheWxvYWQpO1xuICAgIGFkZFRvQ2FydChwYXlsb2FkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWRpcmVjdCB0byBjYXJ0IGFmdGVyIGFkZFRvQ2FydCBzdWNjZXNzIG9yIHNob3cgYnVzaW5lc3MgZXJyb3JcbiAgICpcbiAgICogQHBhcmFtICB7T2JqZWN0fSBwYXlsb2FkIC0gYWRkVG9DYXJ0IHBheWxvYWQgYnVpbGRlZFxuICAgKi9cbiAgZnVuY3Rpb24gcmVkaXJlY3RPclNob3dCdXNpbmVzc0Vycm9yKHJlc3VsdCkge1xuICAgIGlmIChyZXN1bHQuZGF0YS5lcnJvcnMgJiYgcmVzdWx0LmRhdGEuZXJyb3JzLmxlbmd0aCA+IDApIHtcblxuICAgICAgdmFyIGJ0bkF0cmlidXRlID0gJ2RhdGEtZXJyb3InO1xuICAgICAgdmFyIGVycm9yTWVzc2FnZSA9IG51bGw7XG4gICAgICAvL3Nob3cgdGhlIGZpcnN0IGVycm9yXG4gICAgICBpZiAocmVzdWx0LmRhdGEuZXJyb3JzWzBdLmNvZGUgPT09IFNUT0NLX0VSUk9SX0NPREUpIHtcbiAgICAgICAgYnRuQXRyaWJ1dGUgPSAnZGF0YS1lcnJvci0nICsgU1RPQ0tfRVJST1JfQ09ERTtcbiAgICAgIH1cblxuICAgICAgaWYocmVzdWx0LmRhdGEuZXJyb3JzWzBdLmNvZGUgPT09ICdwZXJzb25hbGl6YXRpb24ubm90LmFsbG93ZWQnKSB7XG4gICAgICAgIGVycm9yTWVzc2FnZSA9IHdpbmRvdy5mcmVlZG9tLmkxOG4uZ2V0TWVzc2FnZSgncHJvZHVjdF9lcnJvcnNfY2FydF9wZXJzb25hX25vdF9hbGxvdycpOyAvL2dldCBtZXNzYWdlIGVycm9yXG4gICAgICB9XG5cbiAgICAgIHZhciBidG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChQUk9EVUNUX0JVWV9CVVRUT04pO1xuICAgICAgaWYoYnRucykge1xuICAgICAgICB2YXIgaSA9IGJ0bnMubGVuZ3RoO1xuXG4gICAgICAgIHdoaWxlKGktLSkge1xuICAgICAgICAgIHNob3dCdXlFcnJvcihlcnJvck1lc3NhZ2UgfHwgYnRuc1tpXS5nZXRBdHRyaWJ1dGUoYnRuQXRyaWJ1dGUpKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgLy8gSWYgcXVpY2tWaWV3IHdpbGwgbm90IGhhdmUgcmVkaXJlY3QgYWZ0ZXIgYWRkIHRvIGNhcnRcbiAgICB9IGVsc2UgaWYgKHdpbmRvdy5mcmVlZG9tLm5zUHViU3ViLnB1YigncXVpY2tWaWV3Lmhhc1F1aWNrVmlldycpKSB7XG4gICAgICB3aW5kb3cuZnJlZWRvbS5uc1B1YlN1Yi5wdWIoJ3F1aWNrVmlldy5jbG9zZScpO1xuICAgICAgd2luZG93LmZyZWVkb20ubnNQdWJTdWIucHViKCdtaW5pQ2FydC5maXhlZCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvY2FydCc7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFkZCBwcm9kdWN0IHRvIGNhcnQuXG4gICAqXG4gICAqIEBwYXJhbSAge09iamVjdH0gcGF5bG9hZCAtIGFkZFRvQ2FydCBwYXlsb2FkIGJ1aWxkZWRcbiAgICogQGNhbGxiYWNrIGNhbGwgYWRkIHRvIGNhcnQgQVBJIGFuZCByZWRpcmVjdHMgdG8gY2FydCBvciBzaG93IGVycm9yXG4gICAqL1xuICBmdW5jdGlvbiBhZGRUb0NhcnQocGF5bG9hZCkge1xuICAgIHZhciBvcHRpb25zID0ge1xuICAgICAgYnV0dG9uV2l0aExvYWRpbmc6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoUFJPRFVDVF9CVVlfQlVUVE9OKSxcbiAgICAgIG1ldGhvZDogJ3Bvc3QnLFxuICAgICAgZGF0YTogcGF5bG9hZCxcbiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICByZWRpcmVjdE9yU2hvd0J1c2luZXNzRXJyb3IocmVzdWx0KTtcbiAgICAgIH0sXG4gICAgICBlcnJvcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHNob3dCdXlFcnJvcihkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFBST0RVQ1RfQlVZX0JVVFRPTikuZ2V0QXR0cmlidXRlKCdkYXRhLWVycm9yJykpO1xuICAgICAgfVxuICAgIH07XG4gICAgd2luZG93LmZyZWVkb20ucmVzdENsaWVudC5yZXF1ZXN0KCcvY2FydC9hZGQnLCBvcHRpb25zKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBbc2hvd0J1eUVycm9yXVxuICAgKiBzaG93IGVycm9yIG1lc3NhZ2UgaW4gY2FzZSBvZiBhZGRUb0NhcnQgZmFpbHNcbiAgICogQHBhcmFtICB7U3RyaW5nfSBtZXNzYWdlIFtlcnJvciBtZXNzYWdlXVxuICAgKiBAcmV0dXJuIHt9XG4gICAqL1xuICBmdW5jdGlvbiBzaG93QnV5RXJyb3IobWVzc2FnZSkge1xuICAgIHRyeSB7XG4gICAgICB2YXIgZXJyb3JFbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNidXktZXJyb3InKTtcbiAgICAgIGlmKGVycm9yRWxlbWVudHMpIHtcbiAgICAgICAgdmFyIGkgPSBlcnJvckVsZW1lbnRzLmxlbmd0aDtcblxuICAgICAgICB3aGlsZShpLS0pIHtcbiAgICAgICAgICBlcnJvckVsZW1lbnRzW2ldLmlubmVySFRNTCA9IG1lc3NhZ2U7XG4gICAgICAgICAgd2luZG93LmZyZWVkb20ucmVtb3ZlQ2xhc3MoZXJyb3JFbGVtZW50c1tpXSwgJ2hpZGRlbicpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50ZXN0LWFiLWN0YS1mbG9hdGluZyAucmlnaHQgI2J1eS1idXR0b24tY3RhJykucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdjYWxsLXRvLWFjdGlvbi5zaG93QnV5RXJyb3InLCBlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIGZ1bmN0aW9uIHRvIHZhbGlkYXRlIGlmIHBlcnNvbmEgaXMgb3BlbiBhbmQgdGhlIGZpZWxkcyBpcyBwYXJ0aWFsIGNvbXBsZXRlXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gcGVyc29uYVN0YXR1cyBzdGF0dXMgb2YgcGVyc29uYVxuICAgKi9cbiAgZnVuY3Rpb24gY2hlY2tQZXJzb25hKHBlcnNvbmFTdGF0dXMpIHtcbiAgICB0cnkge1xuICAgICAgaWYocGVyc29uYVN0YXR1cykge1xuICAgICAgICBpc1NpemVWYWxpZCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGVycm9yTWVzc2FnZSA9IHdpbmRvdy5mcmVlZG9tLmkxOG4uZ2V0TWVzc2FnZSgncGVyc29uYWxpemF0aW9uX2ZpZWxkc19nZW5lcmljX2Vycm9yJyk7XG4gICAgICAgIHNob3dCdXlFcnJvcihlcnJvck1lc3NhZ2UpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdjYWxsLXRvLWFjdGlvbi5jaGVja1BlcnNvbmEnLCBlcnJvcik7XG4gICAgICBpc1NpemVWYWxpZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBmdW5jdGlvbiB0byBoYW5kbGUgdGhlIGJ1eSBidXR0b24gZXZlbnQsIGNoZWNrIHRoZSB2YWxpZGF0aW9ucyBldGMuLi5cbiAgICovXG4gIGZ1bmN0aW9uIGhhbmRsZUJ1eUV2ZW50KCkge1xuICAgIHRyeSB7XG4gICAgICB2YXIgaGFzUGVyc29uYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXBlcnNvbmFdJyk7XG4gICAgICB2YXIgbmV3UGVyc29uYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLW5ldy1wZXJzb25hXScpO1xuICAgICAgdmFyIGhhc0J1aWxkZXJQZXJzb25hID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtYnVpbGRlci1wZXJzb25hXScpO1xuXG4gICAgICBpZihoYXNQZXJzb25hICYmIG5ld1BlcnNvbmEgJiYgIWhhc0J1aWxkZXJQZXJzb25hKSB7XG4gICAgICAgIHdpbmRvdy5mcmVlZG9tLm5zUHViU3ViLnB1YignQ29sb3JGbGF2b3JTaXplLmhhbmRsZUJ1eUV2ZW50LmNoZWNrUGVyc29uYScsIGNoZWNrUGVyc29uYSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpc1NpemVWYWxpZCgpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdjYWxsLXRvLWFjdGlvbi5oYW5kbGVCdXlFdmVudCcsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVGVzdCBBQiBDVEEgRmxvYXRpbmdcbiAgICovXG5cbiAgLyoqXG4gICAqIFtzaG93RmxvYXRlcl1cbiAgICogT3BlbiB0aGUgYm94IG9mIENBVCBGbG9hdGluZ1xuICAgKi9cbiAgZnVuY3Rpb24gc2hvd0Zsb2F0ZXIoKSB7XG4gICAgaWYgKGN0YUZsb2F0ZXIgJiYgYm9keSkge1xuICAgICAgdmFyIGJvZHlUb3AgPSBib2R5LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcDtcblxuICAgICAgaWYgKGJvZHlUb3AgPCAtNTU2KSB7XG4gICAgICAgIGlmIChjdGFGbG9hdGVyLmNsYXNzTmFtZS5pbmRleE9mKCdjdGEtb3Blbi1mbG9hdGVyJykgPCAwKSB7XG4gICAgICAgICAgd2luZG93LmZyZWVkb20uYWRkQ2xhc3MoYm9keSwnY3RhLW9wZW4tZmxvYXRlcicpO1xuICAgICAgICAgIGhpZGVNZXNzYWdlRXJyb3IoKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgd2luZG93LmZyZWVkb20ucmVtb3ZlQ2xhc3MoYm9keSwnY3RhLW9wZW4tZmxvYXRlcicpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBbc2Nyb2xsRnVuY3Rpb25dXG4gICAqIEFwcGx5IHNjcm9sbCBldmVudCBmb3IgdG8gc2hvdyBDVEEgRmxvYXRpbmdcbiAgICovXG4gIGZ1bmN0aW9uIHNjcm9sbEZ1bmN0aW9uKCkge1xuICAgIGlmKGN0YUZsb2F0ZXIpIHtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBzaG93RmxvYXRlcik7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gYW5jaG9yUmV2aWV3cygpIHtcbiAgICBpZihkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGVzdC1hYi1jdGEtZmxvYXRpbmcgLnJhdGluZy1zdGFycz5hJykgIT09IG51bGwpIHtcbiAgICAgIHZhciBhbmNob3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucmF0aW5nLXN0YXJzPmEnKTtcbiAgICAgIGFuY2hvci5mb3JFYWNoKGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICB2YXIgZGl2UmV2aWV3cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yZXZpZXdzJykub2Zmc2V0VG9wO1xuICAgICAgICAgIHdpbmRvdy5zY3JvbGxUbygwLGRpdlJldmlld3MgLSAxNjApO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAgKiBbdGVsbE1lYmFja11cbiAgICAqIHdoZW4gdGhlIGZvcm0gdGVsbCBtZSBpcyBvcGVuLCBhZGQgY2xpY2sgZXZlbnQgaW4gdGhlIGFycm93IHRvIGJhY2sgYW5kIHNlbGVjdCBzaXplIGl0ZW0uXG4gICAgKlxuICAqL1xuICBmdW5jdGlvbiB0ZWxsTWViYWNrKCkge1xuICAgIHdpbmRvdy5mcmVlZG9tLmxpdmUoJ2J1dHRvbi50ZWxsX21lX2JhY2snLCAnY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBzaXplID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI2J1eS1ib3ggW2RhdGEtdHlwZT1zaXplXSAucHJvZHVjdC1pdGVtW3FhLW9wdGlvbj1cImF2YWlsYWJsZVwiXScpO1xuICAgICAgaWYoc2l6ZS5sZW5ndGgpIHtcbiAgICAgICAgc2l6ZVswXS5jbGljaygpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2l6ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNidXktYm94IFtkYXRhLXR5cGU9Y29sb3JdIC5ucy1jb2xvcltxYS1vcHRpb249XCJhdmFpbGFibGVcIl0nKTtcbiAgICAgICAgc2l6ZVswXS5jbGljaygpO1xuICAgICAgfVxuXG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGVzdC1hYi1jdGEtZmxvYXRpbmcgLmZvcm0tdGVsbC1tZScpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBzaG93U2l6ZUZsb2F0aW5nKCkge1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50ZXN0LWFiLWN0YS1mbG9hdGluZyAucHJvZHVjdC1pbmZvJykuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGVzdC1hYi1jdGEtZmxvYXRpbmcgLnNlbGVjdG9yLWNvbG9yJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgd2luZG93LmZyZWVkb20uYWRkQ2xhc3MoYm9keSwnY3RhLXByb2R1Y3Qtc2l6ZScpO1xuICB9XG5cbiAgZnVuY3Rpb24gc2hvd0luZm9Qcm9kKCkge1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50ZXN0LWFiLWN0YS1mbG9hdGluZyAucHJvZHVjdC1pbmZvJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRlc3QtYWItY3RhLWZsb2F0aW5nIC5zZWxlY3Rvci1jb2xvcicpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gIH1cblxuICBmdW5jdGlvbiBoaWRlTWVzc2FnZUVycm9yKCkge1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5idXktZXJyb3InKS5mb3JFYWNoKGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgfSk7XG4gIH1cblxuICAvKlxuICAgICogW29ic2VydmVTaXplXVxuICAgICogRnVuY3Rpb24gZm9yIE9ic2VydmUgZXZlbnRzXG4gICAgKlxuICAqL1xuICBmdW5jdGlvbiBvYnNlcnZlU2l6ZSgpIHtcbiAgICB3aW5kb3cuZnJlZWRvbS5saXZlKCcjYnV5LWJveCAuc2t1LXNlbGVjdCBbZGF0YS10eXBlPXNpemVdIGxpJywgJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICBpZihldmVudC50YXJnZXQucGFyZW50RWxlbWVudC5jbGFzc05hbWUuaW5kZXhPZigndW5hdmFpbGFibGUnKSA+PSAwKSB7XG4gICAgICAgIHdpbmRvdy5mcmVlZG9tLnJlbW92ZUNsYXNzKGJvZHksJ2N0YS1wcm9kdWN0LXNpemUnKTtcbiAgICAgICAgd2luZG93LmZyZWVkb20uYWRkQ2xhc3MoYm9keSwnY3RhLXByb2R1Y3QtdW5hdmFpbGFibGUnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHdpbmRvdy5mcmVlZG9tLnJlbW92ZUNsYXNzKGJvZHksJ2N0YS1wcm9kdWN0LXVuYXZhaWxhYmxlJyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB3aW5kb3cuZnJlZWRvbS5uc1B1YlN1Yi5zdWIoJ2NvbG9yLWZsYXZvci1zaXplLmNoYW5nZUh0bWwuYWZ0ZXInLGZ1bmN0aW9uKCkge1xuICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmKCFkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdsaS51bmF2YWlsYWJsZS5hY3RpdmUnKS5sZW5ndGgpIHtcbiAgICAgICAgICBpZihkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGVsbC1tZS1idXR0b24td3JhcHBlcicpLmxlbmd0aCkge1xuICAgICAgICAgICAgd2luZG93LmZyZWVkb20uYWRkQ2xhc3MoYm9keSwnY3RhLXByb2R1Y3QtdW5hdmFpbGFibGUnKTtcbiAgICAgICAgICAgIHdpbmRvdy5mcmVlZG9tLnJlbW92ZUNsYXNzKGJvZHksJ2N0YS1wcm9kdWN0LXNpemUnKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtdHlwZT1zaXplXSBsaS5hY3RpdmUnKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgLy9BdGl2YSBvIGJvdMOjbyBjb21wcmFyIGUgZGlyZWNpb25hIHBhcmEgbyBjYXJyaW5ob1xuICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5JykuY2xhc3NMaXN0LnJlbW92ZSgnY3RhLXByb2R1Y3Qtc2l6ZScpO1xuICAgICAgICAgICAgICBzaG93SW5mb1Byb2QoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdpbmRvdy5mcmVlZG9tLnJlbW92ZUNsYXNzKGJvZHksJ2N0YS1wcm9kdWN0LXVuYXZhaWxhYmxlJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50ZWxsLW1lLWJ1dHRvbi13cmFwcGVyJykubGVuZ3RoKSB7XG4gICAgICAgICAgICB3aW5kb3cuZnJlZWRvbS5hZGRDbGFzcyhib2R5LCdjdGEtcHJvZHVjdC11bmF2YWlsYWJsZScpO1xuICAgICAgICAgICAgd2luZG93LmZyZWVkb20ucmVtb3ZlQ2xhc3MoYm9keSwnY3RhLXByb2R1Y3Qtc2l6ZScpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB3aW5kb3cuZnJlZWRvbS5yZW1vdmVDbGFzcyhib2R5LCdjdGEtcHJvZHVjdC11bmF2YWlsYWJsZScpO1xuICAgICAgICAgICAgc2hvd0luZm9Qcm9kKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LDEwMDApO1xuICAgIH0pO1xuXG4gICAgd2luZG93LmZyZWVkb20ubGl2ZSgnI2J1eS1idXR0b24tY3RhJywgJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRlc3QtYWItY3RhLWZsb2F0aW5nIC5yaWdodCAjYnV5LWJ1dHRvbi1jdGEnKS5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywnZGlzYWJsZWQnKTtcbiAgICAgIGlmKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNidXktYm94IC5wcm9kdWN0LXNpemUtc2VsZWN0b3IgLnJhZGlvLW9wdGlvbnMgbGkuYWN0aXZlJykubGVuZ3RoKSB7XG4gICAgICAgIC8vU2l6ZSBzZWxlY3RlZFxuICAgICAgICBoYW5kbGVCdXlFdmVudCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2hvd1NpemVGbG9hdGluZygpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLypcbiAgICAqIFtoYW5kbGVCdXlFdmVudENUQUZsb2F0aW5nXVxuICAgICpcbiAgKi9cbiAgZnVuY3Rpb24gaGFuZGxlQnV5RXZlbnRDVEFGbG9hdGluZyhlbGVtZW50KSB7XG4gICAgdHJ5IHtcbiAgICAgIGlmKCFlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhcInVuYXZhaWxhYmxlXCIpKSB7XG4gICAgICAgIGhhbmRsZUJ1eUV2ZW50KCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB3aW5kb3cuZnJlZWRvbS5yZW1vdmVDbGFzcyhib2R5LCdjdGEtcHJvZHVjdC1zaXplJyk7XG4gICAgICAgIHdpbmRvdy5mcmVlZG9tLmFkZENsYXNzKGJvZHksJ2N0YS1wcm9kdWN0LXVuYXZhaWxhYmxlJyk7XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50ZXN0LWFiLWN0YS1mbG9hdGluZyAuZm9ybS10ZWxsLW1lJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ2NhbGwtdG8tYWN0aW9uLmhhbmRsZUJ1eUV2ZW50JywgZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAgKiBbc2V0TGlzdGVuZXJzQ1RBRmxvYXRpbmddXG4gICAgKiBhZGQgY2xpY2sgZXZlbnQgaW4gdGhlIHNpemUgaXRlbVxuICAgICpcbiAgKi9cbiAgZnVuY3Rpb24gc2V0TGlzdGVuZXJzQ1RBRmxvYXRpbmcoKSB7XG4gICAgd2luZG93LmZyZWVkb20ubGl2ZSgnLnRlc3QtYWItY3RhLWZsb2F0aW5nIFtkYXRhLXR5cGU9c2l6ZV0gbGknLCAnY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBoYW5kbGVCdXlFdmVudENUQUZsb2F0aW5nKHRoaXMpO1xuICAgIH0pO1xuICB9XG5cbiAgLypcbiAgICAqIFtpbml0RmxvYXRlcl1cbiAgICAqIFZlcmlmeSBpZiB2YXJpYW50IG9mIG9wdGltaXplIHdhcyBzdGFydGVkXG4gICAgKlxuICAqL1xuICBmdW5jdGlvbiBpbml0RmxvYXRlcigpIHtcbiAgICBpZiAoY3RhRmxvYXRlci5nZXRBdHRyaWJ1dGUoJ2RhdGEtY3RhLWZsb2F0ZXInKSAhPT0gbnVsbCkge1xuICAgICAgc2Nyb2xsRnVuY3Rpb24oKTtcbiAgICAgIG9ic2VydmVTaXplKCk7XG5cbiAgICAgIHNldExpc3RlbmVyc0NUQUZsb2F0aW5nKCk7XG4gICAgICB0ZWxsTWViYWNrKCk7XG4gICAgICBhbmNob3JSZXZpZXdzKCk7XG5cbiAgICAgIGlmKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50ZWxsLW1lLWJ1dHRvbi13cmFwcGVyJykubGVuZ3RoKSB7XG4gICAgICAgIHdpbmRvdy5mcmVlZG9tLnJlbW92ZUNsYXNzKGJvZHksJ2N0YS1wcm9kdWN0LXNpemUnKTtcbiAgICAgICAgd2luZG93LmZyZWVkb20uYWRkQ2xhc3MoYm9keSwnY3RhLXByb2R1Y3QtdW5hdmFpbGFibGUnKTtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRlc3QtYWItY3RhLWZsb2F0aW5nIC5mb3JtLXRlbGwtbWUnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKlxuICAgICogW2luaXRdXG4gICAgKiBWZXJpZnkgaWYgdGhlcmUgaXMgZWxlbWVudCBvZiBDVEFcbiAgICAqXG4gICovXG4gIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgY3RhRmxvYXRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50ZXN0LWFiLWN0YS1mbG9hdGluZycpO1xuICAgIGlmKGN0YUZsb2F0ZXIpIHtcbiAgICAgIGluaXRGbG9hdGVyKCk7XG4gICAgfVxuICB9XG5cbiAgKGZ1bmN0aW9uKCkge1xuICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgaW5pdCgpO1xuICAgIH0sMjUwMCk7XG4gIH0oKSk7XG5cbn0oKSk7XG4iXX0=
