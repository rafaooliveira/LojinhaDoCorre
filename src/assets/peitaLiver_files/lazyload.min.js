var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.LazyLoad=t()}(this,function(){"use strict";var e={elements_selector:"img",container:document,threshold:300,data_src:"src",data_srcset:"srcset",class_loading:"loading",class_loaded:"loaded",class_error:"error",callback_load:null,callback_error:null,callback_set:null,callback_enter:null},t="data-",n=function(e,n){return e.getAttribute(t+n)},r=function(e,n,r){return e.setAttribute(t+n,r)},s=function(e){return e.filter(function(e){return!n(e,"was-processed")})},o=function(e,t){var n,r="LazyLoad::Initialized",s=new e(t);try{n=new CustomEvent(r,{detail:{instance:s}})}catch(o){n=document.createEvent("CustomEvent"),n.initCustomEvent(r,!1,!1,{instance:s})}window.dispatchEvent(n)},i=function(e,t){if(t.length)for(var n,r=0;n=t[r];r+=1)o(e,n);else o(e,t)},a=function(e,t){var r=t.data_srcset,s=e&&e.parentNode?e.parentNode:null;if((!s||"PICTURE"===s.tagName)&&s&&s.children&&s.children.length)for(var o,i=0;o=s.children[i];i+=1)if("SOURCE"===o.tagName){var a=n(o,r);a&&o.setAttribute("srcset",a)}},c=function(e,t){var r=t.data_src,s=t.data_srcset,o=e.tagName,i=n(e,r);if("IMG"===o){a(e,t);var c=n(e,s);return c&&e.setAttribute("srcset",c),void(i&&e.setAttribute("src",i))}return"IFRAME"===o?void(i&&e.setAttribute("src",i)):void(i&&(e.style.backgroundImage='url("'+i+'")'))},l="classList"in document.createElement("p"),u=function(e,t){return l?void e.classList.add(t):void(e.className+=(e.className?" ":"")+t)},d=function(e,t){return l?void e.classList.remove(t):void(e.className=e.className.replace(new RegExp("(^|\\s+)"+t+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,""))},f=function(e,t){e&&e(t)},v="load",_="error",m=function(e,t,n){e.removeEventListener(v,t),e.removeEventListener(_,n)},b=function(e,t){var n=function s(n){h(n,!0,t),m(e,s,r)},r=function o(r){h(r,!1,t),m(e,n,o)};e.addEventListener(v,n),e.addEventListener(_,r)},h=function(e,t,n){var r=e.target;d(r,n.class_loading),u(r,t?n.class_loaded:n.class_error),f(t?n.callback_load:n.callback_error,r)},p=function(e,t){f(t.callback_enter,e),["IMG","IFRAME"].indexOf(e.tagName)>-1&&(b(e,t),u(e,t.class_loading)),c(e,t),r(e,"was-processed",!0),f(t.callback_set,e)},y=function(t,n){this._settings=_extends({},e,t),this._setObserver(),this.update(n)};y.prototype={_setObserver:function(){var e=this;if("IntersectionObserver"in window){var t=this._settings,n=function(n){n.forEach(function(n){if(n.intersectionRatio>0){var r=n.target;p(r,t),e._observer.unobserve(r)}}),e._elements=s(e._elements)};this._observer=new IntersectionObserver(n,{root:t.container===document?null:t.container,rootMargin:t.threshold+"px"})}},update:function(e){var t=this,n=this._settings,r=e||n.container.querySelectorAll(n.elements_selector);return this._elements=s(Array.prototype.slice.call(r)),this._observer?void this._elements.forEach(function(e){t._observer.observe(e)}):(this._elements.forEach(function(e){p(e,n)}),void(this._elements=s(this._elements)))},destroy:function(){var e=this;this._observer&&(s(this._elements).forEach(function(t){e._observer.unobserve(t)}),this._observer=null),this._elements=null,this._settings=null}};var g=window.lazyLoadOptions;return g&&i(y,g),y});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIl9yZWZhY3RvcmluZy9fbGliL3ZlbmRvci9sYXp5bG9hZC5taW4uanMiXSwibmFtZXMiOlsiX2V4dGVuZHMiLCJPYmplY3QiLCJhc3NpZ24iLCJ0YXJnZXQiLCJpIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwic291cmNlIiwia2V5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiX3R5cGVvZiIsIlN5bWJvbCIsIml0ZXJhdG9yIiwib2JqIiwiY29uc3RydWN0b3IiLCJnbG9iYWwiLCJmYWN0b3J5IiwiZXhwb3J0cyIsIm1vZHVsZSIsImRlZmluZSIsImFtZCIsIkxhenlMb2FkIiwidGhpcyIsImRlZmF1bHRTZXR0aW5ncyIsImVsZW1lbnRzX3NlbGVjdG9yIiwiY29udGFpbmVyIiwiZG9jdW1lbnQiLCJ0aHJlc2hvbGQiLCJkYXRhX3NyYyIsImRhdGFfc3Jjc2V0IiwiY2xhc3NfbG9hZGluZyIsImNsYXNzX2xvYWRlZCIsImNsYXNzX2Vycm9yIiwiY2FsbGJhY2tfbG9hZCIsImNhbGxiYWNrX2Vycm9yIiwiY2FsbGJhY2tfc2V0IiwiY2FsbGJhY2tfZW50ZXIiLCJkYXRhUHJlZml4IiwiZ2V0RGF0YSIsImVsZW1lbnQiLCJhdHRyaWJ1dGUiLCJnZXRBdHRyaWJ1dGUiLCJzZXREYXRhIiwidmFsdWUiLCJzZXRBdHRyaWJ1dGUiLCJwdXJnZUVsZW1lbnRzIiwiZWxlbWVudHMiLCJmaWx0ZXIiLCJjcmVhdGVJbnN0YW5jZSIsImNsYXNzT2JqIiwib3B0aW9ucyIsImV2ZW50IiwiZXZlbnRTdHJpbmciLCJpbnN0YW5jZSIsIkN1c3RvbUV2ZW50IiwiZGV0YWlsIiwiZXJyIiwiY3JlYXRlRXZlbnQiLCJpbml0Q3VzdG9tRXZlbnQiLCJ3aW5kb3ciLCJkaXNwYXRjaEV2ZW50IiwiYXV0b0luaXRpYWxpemUiLCJvcHRpb25zSXRlbSIsInNldFNvdXJjZXNGb3JQaWN0dXJlIiwic2V0dGluZ3MiLCJkYXRhU3JjU2V0IiwicGFyZW50IiwicGFyZW50Tm9kZSIsInRhZ05hbWUiLCJjaGlsZHJlbiIsInBpY3R1cmVDaGlsZCIsInNvdXJjZVNyY3NldCIsInNldFNvdXJjZXMiLCJkYXRhU3JjIiwiZWxlbWVudFNyYyIsImltZ1NyY3NldCIsInN0eWxlIiwiYmFja2dyb3VuZEltYWdlIiwic3VwcG9ydHNDbGFzc0xpc3QiLCJjcmVhdGVFbGVtZW50IiwiYWRkQ2xhc3MiLCJjbGFzc05hbWUiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmVDbGFzcyIsInJlbW92ZSIsInJlcGxhY2UiLCJSZWdFeHAiLCJjYWxsQ2FsbGJhY2siLCJjYWxsYmFjayIsImFyZ3VtZW50IiwibG9hZFN0cmluZyIsImVycm9yU3RyaW5nIiwicmVtb3ZlTGlzdGVuZXJzIiwibG9hZEhhbmRsZXIiLCJlcnJvckhhbmRsZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiYWRkT25lU2hvdExpc3RlbmVycyIsIm9uTG9hZCIsIm9uRXZlbnQiLCJvbkVycm9yIiwiYWRkRXZlbnRMaXN0ZW5lciIsInN1Y2Nlc3MiLCJyZXZlYWxFbGVtZW50IiwiaW5kZXhPZiIsImluc3RhbmNlU2V0dGluZ3MiLCJfc2V0dGluZ3MiLCJfc2V0T2JzZXJ2ZXIiLCJ1cGRhdGUiLCJfdGhpcyIsIm9uSW50ZXJzZWN0aW9uIiwiZW50cmllcyIsImZvckVhY2giLCJlbnRyeSIsImludGVyc2VjdGlvblJhdGlvIiwiX29ic2VydmVyIiwidW5vYnNlcnZlIiwiX2VsZW1lbnRzIiwiSW50ZXJzZWN0aW9uT2JzZXJ2ZXIiLCJyb290Iiwicm9vdE1hcmdpbiIsIl90aGlzMiIsIm5vZGVTZXQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiQXJyYXkiLCJzbGljZSIsIm9ic2VydmUiLCJkZXN0cm95IiwiX3RoaXMzIiwiYXV0b0luaXRPcHRpb25zIiwibGF6eUxvYWRPcHRpb25zIl0sIm1hcHBpbmdzIjoiQUFBQSxHQUFJQSxVQUFXQyxPQUFPQyxRQUFVLFNBQVVDLEdBQVUsSUFBSyxHQUFJQyxHQUFJLEVBQUdBLEVBQUlDLFVBQVVD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eEUsRUFBYytFLE1BQU1ySCxVQUFVc0gsTUFBTXBILEtBQUtpSCxJQUN0RHBHLEtBQUs2RixjQUNMN0YsTUFBSytGLFVBQVVMLFFBQVEsU0FBVXpFLEdBQzdCa0YsRUFBT04sVUFBVVcsUUFBUXZGLE1BS2pDakIsS0FBSytGLFVBQVVMLFFBQVEsU0FBVXpFLEdBQzdCZ0UsRUFBY2hFLEVBQVN5QixVQUUzQjFDLEtBQUsrRixVQUFZeEUsRUFBY3ZCLEtBQUsrRixjQUd4Q1UsUUFBUyxXQUNMLEdBQUlDLEdBQVMxRyxJQUVUQSxNQUFLNkYsWUFDTHRFLEVBQWN2QixLQUFLK0YsV0FBV0wsUUFBUSxTQUFVekUsR0FDNUN5RixFQUFPYixVQUFVQyxVQUFVN0UsS0FFL0JqQixLQUFLNkYsVUFBWSxNQUVyQjdGLEtBQUsrRixVQUFZLEtBQ2pCL0YsS0FBS29GLFVBQVksTUFLekIsSUFBSXVCLEdBQWtCdEUsT0FBT3VFLGVBSzdCLE9BSklELElBQ0FwRSxFQUFleEMsRUFBVTRHLEdBR3RCNUciLCJmaWxlIjoiX3JlZmFjdG9yaW5nL19saWIvdmVuZG9yL2xhenlsb2FkLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldOyBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7IHRhcmdldFtrZXldID0gc291cmNlW2tleV07IH0gfSB9IHJldHVybiB0YXJnZXQ7IH07XG5cbnZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTtcblxuKGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHtcbiAgICAodHlwZW9mIGV4cG9ydHMgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKGV4cG9ydHMpKSA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgPyBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKSA6IHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShmYWN0b3J5KSA6IGdsb2JhbC5MYXp5TG9hZCA9IGZhY3RvcnkoKTtcbn0pKHRoaXMsIGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgZGVmYXVsdFNldHRpbmdzID0ge1xuICAgICAgICBlbGVtZW50c19zZWxlY3RvcjogXCJpbWdcIixcbiAgICAgICAgY29udGFpbmVyOiBkb2N1bWVudCxcbiAgICAgICAgdGhyZXNob2xkOiAzMDAsXG4gICAgICAgIGRhdGFfc3JjOiBcInNyY1wiLFxuICAgICAgICBkYXRhX3NyY3NldDogXCJzcmNzZXRcIixcbiAgICAgICAgY2xhc3NfbG9hZGluZzogXCJsb2FkaW5nXCIsXG4gICAgICAgIGNsYXNzX2xvYWRlZDogXCJsb2FkZWRcIixcbiAgICAgICAgY2xhc3NfZXJyb3I6IFwiZXJyb3JcIixcbiAgICAgICAgY2FsbGJhY2tfbG9hZDogbnVsbCxcbiAgICAgICAgY2FsbGJhY2tfZXJyb3I6IG51bGwsXG4gICAgICAgIGNhbGxiYWNrX3NldDogbnVsbCxcbiAgICAgICAgY2FsbGJhY2tfZW50ZXI6IG51bGxcbiAgICB9O1xuXG4gICAgdmFyIGRhdGFQcmVmaXggPSBcImRhdGEtXCI7XG5cbiAgICB2YXIgZ2V0RGF0YSA9IGZ1bmN0aW9uIGdldERhdGEoZWxlbWVudCwgYXR0cmlidXRlKSB7XG4gICAgICAgIHJldHVybiBlbGVtZW50LmdldEF0dHJpYnV0ZShkYXRhUHJlZml4ICsgYXR0cmlidXRlKTtcbiAgICB9O1xuXG4gICAgdmFyIHNldERhdGEgPSBmdW5jdGlvbiBzZXREYXRhKGVsZW1lbnQsIGF0dHJpYnV0ZSwgdmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIGVsZW1lbnQuc2V0QXR0cmlidXRlKGRhdGFQcmVmaXggKyBhdHRyaWJ1dGUsIHZhbHVlKTtcbiAgICB9O1xuXG4gICAgdmFyIHB1cmdlRWxlbWVudHMgPSBmdW5jdGlvbiBwdXJnZUVsZW1lbnRzKGVsZW1lbnRzKSB7XG4gICAgICAgIHJldHVybiBlbGVtZW50cy5maWx0ZXIoZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiAhZ2V0RGF0YShlbGVtZW50LCBcIndhcy1wcm9jZXNzZWRcIik7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICAvKiBDcmVhdGVzIGluc3RhbmNlIGFuZCBub3RpZmllcyBpdCB0aHJvdWdoIHRoZSB3aW5kb3cgZWxlbWVudCAqL1xuICAgIHZhciBjcmVhdGVJbnN0YW5jZSA9IGZ1bmN0aW9uIGNyZWF0ZUluc3RhbmNlKGNsYXNzT2JqLCBvcHRpb25zKSB7XG4gICAgICAgIHZhciBldmVudDtcbiAgICAgICAgdmFyIGV2ZW50U3RyaW5nID0gXCJMYXp5TG9hZDo6SW5pdGlhbGl6ZWRcIjtcbiAgICAgICAgdmFyIGluc3RhbmNlID0gbmV3IGNsYXNzT2JqKG9wdGlvbnMpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gV29ya3MgaW4gbW9kZXJuIGJyb3dzZXJzXG4gICAgICAgICAgICBldmVudCA9IG5ldyBDdXN0b21FdmVudChldmVudFN0cmluZywgeyBkZXRhaWw6IHsgaW5zdGFuY2U6IGluc3RhbmNlIH0gfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgLy8gV29ya3MgaW4gSW50ZXJuZXQgRXhwbG9yZXIgKGFsbCB2ZXJzaW9ucylcbiAgICAgICAgICAgIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJDdXN0b21FdmVudFwiKTtcbiAgICAgICAgICAgIGV2ZW50LmluaXRDdXN0b21FdmVudChldmVudFN0cmluZywgZmFsc2UsIGZhbHNlLCB7IGluc3RhbmNlOiBpbnN0YW5jZSB9KTtcbiAgICAgICAgfVxuICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgfTtcblxuICAgIC8qIEF1dG8gaW5pdGlhbGl6YXRpb24gb2Ygb25lIG9yIG1vcmUgaW5zdGFuY2VzIG9mIGxhenlsb2FkLCBkZXBlbmRpbmcgb24gdGhlXG4gICAgICAgIG9wdGlvbnMgcGFzc2VkIGluIChwbGFpbiBvYmplY3Qgb3IgYW4gYXJyYXkpICovXG4gICAgdmFyIGF1dG9Jbml0aWFsaXplID0gZnVuY3Rpb24gYXV0b0luaXRpYWxpemUoY2xhc3NPYmosIG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKCFvcHRpb25zLmxlbmd0aCkge1xuICAgICAgICAgICAgLy8gUGxhaW4gb2JqZWN0XG4gICAgICAgICAgICBjcmVhdGVJbnN0YW5jZShjbGFzc09iaiwgb3B0aW9ucyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBBcnJheSBvZiBvYmplY3RzXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgb3B0aW9uc0l0ZW07IG9wdGlvbnNJdGVtID0gb3B0aW9uc1tpXTsgaSArPSAxKSB7XG4gICAgICAgICAgICAgICAgY3JlYXRlSW5zdGFuY2UoY2xhc3NPYmosIG9wdGlvbnNJdGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB2YXIgc2V0U291cmNlc0ZvclBpY3R1cmUgPSBmdW5jdGlvbiBzZXRTb3VyY2VzRm9yUGljdHVyZShlbGVtZW50LCBzZXR0aW5ncykge1xuICAgICAgICB2YXIgZGF0YVNyY1NldCA9IHNldHRpbmdzLmRhdGFfc3Jjc2V0O1xuXG4gICAgICAgIHZhciBwYXJlbnQgPSBlbGVtZW50ICYmIGVsZW1lbnQucGFyZW50Tm9kZSA/IGVsZW1lbnQucGFyZW50Tm9kZSA6IG51bGw7XG4gICAgICAgIGlmIChwYXJlbnQgJiYgcGFyZW50LnRhZ05hbWUgIT09IFwiUElDVFVSRVwiKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmVudCAmJiBwYXJlbnQuY2hpbGRyZW4gJiYgcGFyZW50LmNoaWxkcmVuLmxlbmd0aCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIHBpY3R1cmVDaGlsZDsgcGljdHVyZUNoaWxkID0gcGFyZW50LmNoaWxkcmVuW2ldOyBpICs9IDEpIHtcbiAgICAgICAgICAgICAgICBpZiAocGljdHVyZUNoaWxkLnRhZ05hbWUgPT09IFwiU09VUkNFXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNvdXJjZVNyY3NldCA9IGdldERhdGEocGljdHVyZUNoaWxkLCBkYXRhU3JjU2V0KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZVNyY3NldCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGljdHVyZUNoaWxkLnNldEF0dHJpYnV0ZShcInNyY3NldFwiLCBzb3VyY2VTcmNzZXQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIHZhciBzZXRTb3VyY2VzID0gZnVuY3Rpb24gc2V0U291cmNlcyhlbGVtZW50LCBzZXR0aW5ncykge1xuICAgICAgICB2YXIgZGF0YVNyYyA9IHNldHRpbmdzLmRhdGFfc3JjLFxuICAgICAgICAgICAgZGF0YVNyY1NldCA9IHNldHRpbmdzLmRhdGFfc3Jjc2V0O1xuXG4gICAgICAgIHZhciB0YWdOYW1lID0gZWxlbWVudC50YWdOYW1lO1xuICAgICAgICB2YXIgZWxlbWVudFNyYyA9IGdldERhdGEoZWxlbWVudCwgZGF0YVNyYyk7XG4gICAgICAgIGlmICh0YWdOYW1lID09PSBcIklNR1wiKSB7XG4gICAgICAgICAgICBzZXRTb3VyY2VzRm9yUGljdHVyZShlbGVtZW50LCBzZXR0aW5ncyk7XG4gICAgICAgICAgICB2YXIgaW1nU3Jjc2V0ID0gZ2V0RGF0YShlbGVtZW50LCBkYXRhU3JjU2V0KTtcbiAgICAgICAgICAgIGlmIChpbWdTcmNzZXQpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShcInNyY3NldFwiLCBpbWdTcmNzZXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGVsZW1lbnRTcmMpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShcInNyY1wiLCBlbGVtZW50U3JjKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGFnTmFtZSA9PT0gXCJJRlJBTUVcIikge1xuICAgICAgICAgICAgaWYgKGVsZW1lbnRTcmMpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShcInNyY1wiLCBlbGVtZW50U3JjKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZWxlbWVudFNyYykge1xuICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSAndXJsKFwiJyArIGVsZW1lbnRTcmMgKyAnXCIpJztcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB2YXIgc3VwcG9ydHNDbGFzc0xpc3QgPSBcImNsYXNzTGlzdFwiIGluIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xuXG4gICAgdmFyIGFkZENsYXNzID0gZnVuY3Rpb24gYWRkQ2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lKSB7XG4gICAgICAgIGlmIChzdXBwb3J0c0NsYXNzTGlzdCkge1xuICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZWxlbWVudC5jbGFzc05hbWUgKz0gKGVsZW1lbnQuY2xhc3NOYW1lID8gXCIgXCIgOiBcIlwiKSArIGNsYXNzTmFtZTtcbiAgICB9O1xuXG4gICAgdmFyIHJlbW92ZUNsYXNzID0gZnVuY3Rpb24gcmVtb3ZlQ2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lKSB7XG4gICAgICAgIGlmIChzdXBwb3J0c0NsYXNzTGlzdCkge1xuICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNsYXNzTmFtZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZWxlbWVudC5jbGFzc05hbWUgPSBlbGVtZW50LmNsYXNzTmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAoXCIoXnxcXFxccyspXCIgKyBjbGFzc05hbWUgKyBcIihcXFxccyt8JClcIiksIFwiIFwiKS5yZXBsYWNlKC9eXFxzKy8sIFwiXCIpLnJlcGxhY2UoL1xccyskLywgXCJcIik7XG4gICAgfTtcblxuICAgIHZhciBjYWxsQ2FsbGJhY2sgPSBmdW5jdGlvbiBjYWxsQ2FsbGJhY2soY2FsbGJhY2ssIGFyZ3VtZW50KSB7XG4gICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgY2FsbGJhY2soYXJndW1lbnQpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHZhciBsb2FkU3RyaW5nID0gXCJsb2FkXCI7XG4gICAgdmFyIGVycm9yU3RyaW5nID0gXCJlcnJvclwiO1xuXG4gICAgdmFyIHJlbW92ZUxpc3RlbmVycyA9IGZ1bmN0aW9uIHJlbW92ZUxpc3RlbmVycyhlbGVtZW50LCBsb2FkSGFuZGxlciwgZXJyb3JIYW5kbGVyKSB7XG4gICAgICAgIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihsb2FkU3RyaW5nLCBsb2FkSGFuZGxlcik7XG4gICAgICAgIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihlcnJvclN0cmluZywgZXJyb3JIYW5kbGVyKTtcbiAgICB9O1xuXG4gICAgdmFyIGFkZE9uZVNob3RMaXN0ZW5lcnMgPSBmdW5jdGlvbiBhZGRPbmVTaG90TGlzdGVuZXJzKGVsZW1lbnQsIHNldHRpbmdzKSB7XG4gICAgICAgIHZhciBvbkxvYWQgPSBmdW5jdGlvbiBvbkxvYWQoZXZlbnQpIHtcbiAgICAgICAgICAgIG9uRXZlbnQoZXZlbnQsIHRydWUsIHNldHRpbmdzKTtcbiAgICAgICAgICAgIHJlbW92ZUxpc3RlbmVycyhlbGVtZW50LCBvbkxvYWQsIG9uRXJyb3IpO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgb25FcnJvciA9IGZ1bmN0aW9uIG9uRXJyb3IoZXZlbnQpIHtcbiAgICAgICAgICAgIG9uRXZlbnQoZXZlbnQsIGZhbHNlLCBzZXR0aW5ncyk7XG4gICAgICAgICAgICByZW1vdmVMaXN0ZW5lcnMoZWxlbWVudCwgb25Mb2FkLCBvbkVycm9yKTtcbiAgICAgICAgfTtcbiAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGxvYWRTdHJpbmcsIG9uTG9hZCk7XG4gICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihlcnJvclN0cmluZywgb25FcnJvcik7XG4gICAgfTtcblxuICAgIHZhciBvbkV2ZW50ID0gZnVuY3Rpb24gb25FdmVudChldmVudCwgc3VjY2Vzcywgc2V0dGluZ3MpIHtcbiAgICAgICAgdmFyIGVsZW1lbnQgPSBldmVudC50YXJnZXQ7XG4gICAgICAgIHJlbW92ZUNsYXNzKGVsZW1lbnQsIHNldHRpbmdzLmNsYXNzX2xvYWRpbmcpO1xuICAgICAgICBhZGRDbGFzcyhlbGVtZW50LCBzdWNjZXNzID8gc2V0dGluZ3MuY2xhc3NfbG9hZGVkIDogc2V0dGluZ3MuY2xhc3NfZXJyb3IpOyAvLyBTZXR0aW5nIGxvYWRlZCBvciBlcnJvciBjbGFzc1xuICAgICAgICBjYWxsQ2FsbGJhY2soc3VjY2VzcyA/IHNldHRpbmdzLmNhbGxiYWNrX2xvYWQgOiBzZXR0aW5ncy5jYWxsYmFja19lcnJvciwgZWxlbWVudCk7IC8vIENhbGxpbmcgbG9hZGVkIG9yIGVycm9yIGNhbGxiYWNrXG4gICAgfTtcblxuICAgIHZhciByZXZlYWxFbGVtZW50ID0gZnVuY3Rpb24gcmV2ZWFsRWxlbWVudChlbGVtZW50LCBzZXR0aW5ncykge1xuICAgICAgICBjYWxsQ2FsbGJhY2soc2V0dGluZ3MuY2FsbGJhY2tfZW50ZXIsIGVsZW1lbnQpO1xuICAgICAgICBpZiAoW1wiSU1HXCIsIFwiSUZSQU1FXCJdLmluZGV4T2YoZWxlbWVudC50YWdOYW1lKSA+IC0xKSB7XG4gICAgICAgICAgICBhZGRPbmVTaG90TGlzdGVuZXJzKGVsZW1lbnQsIHNldHRpbmdzKTtcbiAgICAgICAgICAgIGFkZENsYXNzKGVsZW1lbnQsIHNldHRpbmdzLmNsYXNzX2xvYWRpbmcpO1xuICAgICAgICB9XG4gICAgICAgIHNldFNvdXJjZXMoZWxlbWVudCwgc2V0dGluZ3MpO1xuICAgICAgICBzZXREYXRhKGVsZW1lbnQsIFwid2FzLXByb2Nlc3NlZFwiLCB0cnVlKTtcbiAgICAgICAgY2FsbENhbGxiYWNrKHNldHRpbmdzLmNhbGxiYWNrX3NldCwgZWxlbWVudCk7XG4gICAgfTtcblxuICAgIHZhciBMYXp5TG9hZCA9IGZ1bmN0aW9uIExhenlMb2FkKGluc3RhbmNlU2V0dGluZ3MsIGVsZW1lbnRzKSB7XG4gICAgICAgIHRoaXMuX3NldHRpbmdzID0gX2V4dGVuZHMoe30sIGRlZmF1bHRTZXR0aW5ncywgaW5zdGFuY2VTZXR0aW5ncyk7XG4gICAgICAgIHRoaXMuX3NldE9ic2VydmVyKCk7XG4gICAgICAgIHRoaXMudXBkYXRlKGVsZW1lbnRzKTtcbiAgICB9O1xuXG4gICAgTGF6eUxvYWQucHJvdG90eXBlID0ge1xuICAgICAgICBfc2V0T2JzZXJ2ZXI6IGZ1bmN0aW9uIF9zZXRPYnNlcnZlcigpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgICAgICAgIGlmICghKFwiSW50ZXJzZWN0aW9uT2JzZXJ2ZXJcIiBpbiB3aW5kb3cpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc2V0dGluZ3MgPSB0aGlzLl9zZXR0aW5ncztcbiAgICAgICAgICAgIHZhciBvbkludGVyc2VjdGlvbiA9IGZ1bmN0aW9uIG9uSW50ZXJzZWN0aW9uKGVudHJpZXMpIHtcbiAgICAgICAgICAgICAgICBlbnRyaWVzLmZvckVhY2goZnVuY3Rpb24gKGVudHJ5KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlbnRyeS5pbnRlcnNlY3Rpb25SYXRpbyA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZW50cnkudGFyZ2V0O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV2ZWFsRWxlbWVudChlbGVtZW50LCBzZXR0aW5ncyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fb2JzZXJ2ZXIudW5vYnNlcnZlKGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgX3RoaXMuX2VsZW1lbnRzID0gcHVyZ2VFbGVtZW50cyhfdGhpcy5fZWxlbWVudHMpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuX29ic2VydmVyID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKG9uSW50ZXJzZWN0aW9uLCB7XG4gICAgICAgICAgICAgICAgcm9vdDogc2V0dGluZ3MuY29udGFpbmVyID09PSBkb2N1bWVudCA/IG51bGwgOiBzZXR0aW5ncy5jb250YWluZXIsXG4gICAgICAgICAgICAgICAgcm9vdE1hcmdpbjogc2V0dGluZ3MudGhyZXNob2xkICsgXCJweFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICB1cGRhdGU6IGZ1bmN0aW9uIHVwZGF0ZShlbGVtZW50cykge1xuICAgICAgICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHZhciBzZXR0aW5ncyA9IHRoaXMuX3NldHRpbmdzO1xuICAgICAgICAgICAgdmFyIG5vZGVTZXQgPSBlbGVtZW50cyB8fCBzZXR0aW5ncy5jb250YWluZXIucXVlcnlTZWxlY3RvckFsbChzZXR0aW5ncy5lbGVtZW50c19zZWxlY3Rvcik7XG5cbiAgICAgICAgICAgIHRoaXMuX2VsZW1lbnRzID0gcHVyZ2VFbGVtZW50cyhBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChub2RlU2V0KSk7IC8vIG5vZGVzZXQgdG8gYXJyYXkgZm9yIElFIGNvbXBhdGliaWxpdHlcbiAgICAgICAgICAgIGlmICh0aGlzLl9vYnNlcnZlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX2VsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLl9vYnNlcnZlci5vYnNlcnZlKGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEZhbGxiYWNrOiBsb2FkIGFsbCBlbGVtZW50cyBhdCBvbmNlXG4gICAgICAgICAgICB0aGlzLl9lbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgcmV2ZWFsRWxlbWVudChlbGVtZW50LCBzZXR0aW5ncyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuX2VsZW1lbnRzID0gcHVyZ2VFbGVtZW50cyh0aGlzLl9lbGVtZW50cyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZGVzdHJveTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fb2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgICAgICBwdXJnZUVsZW1lbnRzKHRoaXMuX2VsZW1lbnRzKS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMy5fb2JzZXJ2ZXIudW5vYnNlcnZlKGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuX29ic2VydmVyID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2VsZW1lbnRzID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX3NldHRpbmdzID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvKiBBdXRvbWF0aWMgaW5zdGFuY2VzIGNyZWF0aW9uIGlmIHJlcXVpcmVkICh1c2VmdWwgZm9yIGFzeW5jIHNjcmlwdCBsb2FkaW5nISkgKi9cbiAgICB2YXIgYXV0b0luaXRPcHRpb25zID0gd2luZG93LmxhenlMb2FkT3B0aW9ucztcbiAgICBpZiAoYXV0b0luaXRPcHRpb25zKSB7XG4gICAgICAgIGF1dG9Jbml0aWFsaXplKExhenlMb2FkLCBhdXRvSW5pdE9wdGlvbnMpO1xuICAgIH1cblxuICAgIHJldHVybiBMYXp5TG9hZDtcbn0pO1xuIl19
